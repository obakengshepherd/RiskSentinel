# ============================================================================
# RiskSentinel Production Environment Configuration
# ============================================================================
# CRITICAL: Store this file securely. Do NOT commit to version control.
# Use Kubernetes secrets or cloud provider secret management in production.
# ============================================================================

# Application Settings
APP_ENV=production
APP_NAME=RiskSentinel
APP_VERSION=1.0.0
DEBUG=False
CORS_ORIGINS=https://dashboard.risksentinel.io,https://api.risksentinel.io

# Database Configuration
DATABASE_URL=postgresql+asyncpg://risksentinel:${DB_PASSWORD}@risksentinel-pg.internal:5432/risksentinel
DATABASE_POOL_SIZE=30
DATABASE_MAX_OVERFLOW=60
DATABASE_POOL_RECYCLE=1800
DATABASE_ECHO=False

# Kafka Configuration (production broker cluster)
KAFKA_BOOTSTRAP_SERVERS=kafka-broker-1:9092,kafka-broker-2:9092,kafka-broker-3:9092
KAFKA_SECURITY_PROTOCOL=PLAINTEXT
KAFKA_PRODUCER_RETRIES=3
KAFKA_PRODUCER_BATCH_SIZE=16384
KAFKA_TOPIC_RAW=rs.transactions.raw
KAFKA_TOPIC_SCORED=rs.transactions.scored
KAFKA_TOPIC_ALERTS=rs.alerts

# Authentication & Security
SECRET_KEY=${SECRET_KEY_PRODUCTION}
JWT_SECRET_KEY=${JWT_SECRET_PRODUCTION}
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24
JWT_REFRESH_EXPIRATION_DAYS=7
API_KEY_ENABLED=True
AUTH_ENABLED=True

# Rate Limiting
RATE_LIMIT_ENABLED=True
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_REQUESTS_PER_SECOND=10
RATE_LIMIT_STORAGE_URL=redis://redis-cache:6379/0

# Fraud Detection Settings (tuned for production)
FRAUD_RISK_THRESHOLD=0.7
HIGH_RISK_THRESHOLD=0.85
CRITICAL_RISK_THRESHOLD=0.95

# Velocity Analysis (detect rapid sequences)
VELOCITY_WINDOW_SECONDS=300
VELOCITY_THRESHOLD=5
VELOCITY_WEIGHT=0.25

# Amount Thresholds
MIN_TRANSACTION_AMOUNT_ZAR=0.01
MAX_TRANSACTION_AMOUNT_ZAR=10000000.00
ANOMALY_AMOUNT_ZSCORE_THRESHOLD=3.0

# Logging & Observability
LOG_LEVEL=WARNING
LOG_FORMAT=json
STRUCTURED_LOGGING_ENABLED=True
LOG_FILE=/var/log/risksentinel/app.log
LOG_ROTATION=daily
LOG_RETENTION_DAYS=30

# Prometheus Metrics
METRICS_ENABLED=True
METRICS_PORT=9090
ENABLE_REQUEST_TRACING=True
METRICS_HISTOGRAMS=True

# Request Validation
MAX_REQUEST_SIZE_MB=10
MAX_TRANSACTION_CREATE_BATCH=500
REQUEST_TIMEOUT_SECONDS=30

# Machine Learning
ML_ENABLED=True
ML_MODEL_PATH=/models/production/rf_fraud_model.pkl
ML_PREDICTION_THRESHOLD=0.6
ML_BATCH_SIZE=100

# Geolocation
GEOLOCATION_ENABLED=True
GEOLOCATION_DB_PATH=/data/maxmind/GeoLite2-City.mmdb
GEOLOCATION_HIGH_RISK_COUNTRIES=KP,IR,SY

# Feature Engineering
FEATURE_ENGINEERING_ENABLED=True
FEATURES_CACHE_ENABLED=True
FEATURES_CACHE_TTL_SECONDS=3600

# Audit Logging
AUDIT_LOGGING_ENABLED=True
AUDIT_LOG_LEVEL=INFO
AUDIT_POLICY_ENFORCEMENT=strict

# Alerting Configuration
ALERT_DISPATCH_ENABLED=True
ALERT_EMAIL_ENABLED=True
ALERT_SLACK_ENABLED=True
ALERT_WEBHOOK_ENABLED=True

# Email Configuration (SMTP for production)
SMTP_SERVER=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USERNAME=apikey
SMTP_PASSWORD=${SENDGRID_API_KEY}
ALERT_EMAIL_FROM=alerts@risksentinel.io
ALERT_EMAIL_TO=fraud-team@yourcompany.com

# Slack Integration
SLACK_WEBHOOK_URL=${SLACK_WEBHOOK_PRODUCTION}
SLACK_CHANNEL=#fraud-alerts
SLACK_ALERT_CRITICAL_ONLY=False

# Webhook Configuration
WEBHOOK_TIMEOUT_SECONDS=10
WEBHOOK_RETRY_COUNT=3
WEBHOOK_RETRY_DELAY_SECONDS=5

# Redis Cache (for rate limiting, session management)
REDIS_URL=redis://redis-cache:6379/0
REDIS_DB=0
CACHE_TTL_SECONDS=3600

# Health Check Configuration
HEALTH_CHECK_ENABLED=True
HEALTH_CHECK_INTERVAL_SECONDS=30
HEALTH_CHECK_TIMEOUT_SECONDS=10

# Feature Flags (for gradual rollouts)
FEATURE_FLAG_VELOCITY_ANALYSIS=True
FEATURE_FLAG_ML_SCORING=True
FEATURE_FLAG_GEOLOCATION_CHECKS=True
FEATURE_FLAG_ANOMALY_DETECTION=True

# Backup & Disaster Recovery
BACKUP_ENABLED=True
BACKUP_SCHEDULE=daily
BACKUP_RETENTION_DAYS=30
BACKUP_LOCATION=s3://risksentinel-backups/

# Compliance & Governance
GDPR_ENABLED=True
AUDIT_TRAIL_RETENTION_DAYS=2555
ENCRYPTION_ALGORITHM=AES-256-GCM
DATA_RETENTION_POLICY=comply_with_regulations

# Monitoring & Alerting Integration
PROMETHEUS_ENABLED=True
PROMETHEUS_SCRAPE_INTERVAL=15s
GRAFANA_URL=https://grafana.risksentinel.io
DATADOG_ENABLED=False
NEW_RELIC_LICENSE_KEY=${NEW_RELIC_KEY}

# Performance Tuning
CONNECTION_POOL_TIMEOUT_SECONDS=30
QUERY_TIMEOUT_SECONDS=30
BACKGROUND_TASK_TIMEOUT_SECONDS=300
ASYNC_TASK_QUEUE=celery
CELERY_BROKER_URL=redis://redis-cache:6379/1
CELERY_RESULT_BACKEND=redis://redis-cache:6379/2

# Kubernetes / Deployment Environment
KUBERNETES_ENABLED=True
REPLICA_COUNT=3
MIN_REPLICAS=2
MAX_REPLICAS=10
TARGET_CPU_UTILIZATION_PERCENTAGE=70
TARGET_MEMORY_UTILIZATION_PERCENTAGE=80

# Sensitive Data Masking (for logs)
MASK_PII_IN_LOGS=True
MASK_PAYMENT_DETAILS=True
MASK_IP_ADDRESSES=False

# ============================================================================
# IMPORTANT PRODUCTION NOTES:
# ============================================================================
# 1. All SECRET_* values MUST be generated securely and stored in K8s secrets
# 2. Use strong passwords for database and API keys (minimum 32 characters)
# 3. Enable TLS/HTTPS for all external communications
# 4. Rotate secrets monthly and update this configuration
# 5. Monitor LOG_LEVEL and switch to INFO temporarily during incidents only
# 6. Keep METRICS_ENABLED=True for continuous observability
# 7. Verify DATABASE_POOL_SIZE matches expected concurrent connections
# 8. Test ALERT_* settings in staging before enabling in production
# 9. Run HEALTH_CHECK_INTERVAL_SECONDS frequently to catch issues early
# 10. Keep AUDIT_LOGGING_ENABLED=True for compliance and incident investigation
# ============================================================================
